<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nimo - Decentralized Youth Identity Network</title>
  <link rel="icon" type="image/svg+xml" href="/favicon.ico">
  
  <!-- Quasar CSS -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/quasar@2.12.0/dist/quasar.prod.css" rel="stylesheet">
  
  <!-- Custom Global Styles -->
  <style>
    body {
      margin: 0;
      font-family: 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- Loading screen while Vue app loads -->
    <div id="loading-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem; z-index: 9999;">
      <div style="text-align: center;">
        <div style="font-size: 2rem; margin-bottom: 1rem;">Nimo</div>
        <div>Loading...</div>
      </div>
    </div>
  </div>

  <!-- Vue 3 and Quasar from CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/quasar@2.12.0/dist/quasar.umd.prod.js"></script>
  
  <!-- Simple Router Implementation -->
  <script>
    // Simple client-side routing
    const { createApp, ref, reactive, computed, onMounted, watch } = Vue;
    const { useQuasar } = Quasar;
    
    // Simple router state
    const router = reactive({
      currentRoute: window.location.pathname || '/',
      push(path) {
        this.currentRoute = path;
        window.history.pushState({}, '', path);
      }
    });
    
    // Listen for browser back/forward buttons
    window.addEventListener('popstate', () => {
      router.currentRoute = window.location.pathname;
    });
    
    // Base Network Configuration
    const BASE_SEPOLIA_CHAIN_ID = 84532;
    const BASE_MAINNET_CHAIN_ID = 8453;
    
    const BASE_NETWORKS = {
      [BASE_SEPOLIA_CHAIN_ID]: {
        chainId: '0x14a34',
        chainName: 'Base Sepolia',
        nativeCurrency: { name: 'Ethereum', symbol: 'ETH', decimals: 18 },
        rpcUrls: ['https://sepolia.base.org'],
        blockExplorerUrls: ['https://sepolia-explorer.base.org']
      }
    };
    
    // Wallet Store (simplified)
    const walletStore = reactive({
      isConnected: false,
      isConnecting: false,
      account: null,
      chainId: null,
      balance: '0',
      
      async connectWallet() {
        if (!window.ethereum) {
          throw new Error('MetaMask is not installed');
        }
        
        this.isConnecting = true;
        try {
          const accounts = await window.ethereum.request({
            method: 'eth_requestAccounts'
          });
          
          this.account = accounts[0];
          this.isConnected = true;
          
          const chainId = await window.ethereum.request({
            method: 'eth_chainId'
          });
          this.chainId = parseInt(chainId, 16);
          
          await this.updateBalance();
          return true;
        } catch (error) {
          console.error('Wallet connection failed:', error);
          throw error;
        } finally {
          this.isConnecting = false;
        }
      },
      
      async updateBalance() {
        if (!this.account) return;
        
        try {
          const balanceWei = await window.ethereum.request({
            method: 'eth_getBalance',
            params: [this.account, 'latest']
          });
          const balanceEth = parseInt(balanceWei, 16) / Math.pow(10, 18);
          this.balance = balanceEth.toString();
        } catch (error) {
          console.error('Balance update failed:', error);
        }
      },
      
      get formattedAddress() {
        if (!this.account) return '';
        return `${this.account.substring(0, 6)}...${this.account.substring(this.account.length - 4)}`;
      },
      
      get formattedBalance() {
        return parseFloat(this.balance).toFixed(4);
      },
      
      get isOnCorrectNetwork() {
        return this.chainId === BASE_SEPOLIA_CHAIN_ID;
      },
      
      get networkName() {
        const network = BASE_NETWORKS[this.chainId];
        return network ? network.chainName : `Unknown (${this.chainId})`;
      }
    });
    
    // Main App
    const app = createApp({
      setup() {
        const $q = useQuasar();
        
        // App state
        const currentComponent = computed(() => {
          switch (router.currentRoute) {
            case '/':
              return 'landing-page';
            case '/dashboard':
              return 'dashboard-page';
            default:
              return 'not-found-page';
          }
        });
        
        // Global methods
        const connectWallet = async () => {
          try {
            await walletStore.connectWallet();
            $q.notify({
              type: 'positive',
              message: 'Wallet connected successfully!',
              position: 'top-right'
            });
            router.push('/dashboard');
          } catch (error) {
            $q.notify({
              type: 'negative',
              message: error.message || 'Failed to connect wallet',
              position: 'top-right'
            });
          }
        };
        
        const scrollTo = (elementId) => {
          const element = document.getElementById(elementId);
          if (element) {
            element.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        };
        
        // Hide loading screen when app is ready
        onMounted(() => {
          setTimeout(() => {
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen) {
              loadingScreen.style.display = 'none';
            }
          }, 500);
        });
        
        return {
          currentComponent,
          walletStore,
          router,
          connectWallet,
          scrollTo
        };
      },
      
      template: `
        <div id="app">
          <component :is="currentComponent" />
        </div>
      `
    });
    
    // Landing Page Component
    app.component('landing-page', {
      setup() {
        const $q = useQuasar();
        
        const features = [
          {
            title: 'NFT Identity',
            description: 'Create a unique, verifiable digital identity as an NFT on the Base network.',
            icon: 'verified_user'
          },
          {
            title: 'Reputation System', 
            description: 'Earn reputation tokens for your contributions and achievements.',
            icon: 'stars'
          },
          {
            title: 'Community Verification',
            description: 'Get your skills verified by trusted community members.',
            icon: 'group'
          },
          {
            title: 'Base Network',
            description: 'Built on Base for fast, cheap transactions.',
            icon: 'account_balance'
          },
          {
            title: 'Opportunity Access',
            description: 'Access jobs, grants, and Web3 opportunities.',
            icon: 'work'
          },
          {
            title: 'Portfolio Growth',
            description: 'Track progress and showcase achievements.',
            icon: 'trending_up'
          }
        ];
        
        const steps = [
          { title: 'Connect Wallet', description: 'Connect MetaMask and switch to Base network' },
          { title: 'Create Identity', description: 'Mint your unique digital identity NFT' },
          { title: 'Start Contributing', description: 'Add contributions and get verified' },
          { title: 'Access Opportunities', description: 'Unlock jobs and collaborations' }
        ];
        
        const stats = [
          { value: '1,200+', label: 'Active Creators' },
          { value: '5,400+', label: 'Verified Contributions' }, 
          { value: '850K', label: 'Reputation Tokens' },
          { value: '320+', label: 'Opportunities' }
        ];
        
        const connectWallet = async () => {
          try {
            await walletStore.connectWallet();
            $q.notify({
              type: 'positive',
              message: 'Welcome to Nimo! Redirecting to dashboard...',
              position: 'top-right'
            });
            setTimeout(() => router.push('/dashboard'), 1500);
          } catch (error) {
            $q.notify({
              type: 'negative',
              message: error.message.includes('MetaMask') 
                ? 'Please install MetaMask to continue'
                : 'Failed to connect wallet',
              position: 'top-right'
            });
          }
        };
        
        const scrollTo = (id) => {
          document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });
        };
        
        return { features, steps, stats, walletStore, connectWallet, scrollTo };
      },
      
      template: `
        <div class="landing-page">
          <!-- Navigation -->
          <q-header class="navbar" style="background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);">
            <q-toolbar class="q-px-lg">
              <q-toolbar-title class="text-primary text-bold">Nimo</q-toolbar-title>
              <q-space />
              <q-btn flat @click="scrollTo('features')" class="q-mr-sm">Features</q-btn>
              <q-btn flat @click="scrollTo('how-it-works')" class="q-mr-sm">How It Works</q-btn>
              <q-btn
                @click="connectWallet"
                :loading="walletStore.isConnecting"
                color="primary"
                :label="walletStore.isConnected ? 'Connected' : 'Connect Wallet'"
                :icon="walletStore.isConnected ? 'check_circle' : 'account_balance_wallet'"
                unelevated
                rounded
              />
            </q-toolbar>
          </q-header>

          <!-- Hero Section -->
          <section class="hero" style="min-height: 100vh; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; padding: 2rem; position: relative;">
            <div class="container" style="max-width: 1200px; margin: 0 auto; width: 100%; z-index: 1;">
              <div class="row items-center q-col-gutter-xl">
                <div class="col-12 col-md-6 text-white">
                  <h1 style="font-size: 3.5rem; font-weight: 700; line-height: 1.2; margin-bottom: 1.5rem;">
                    Build Your Digital Identity on Base
                  </h1>
                  <p style="font-size: 1.25rem; opacity: 0.9; margin-bottom: 2rem; line-height: 1.6;">
                    Nimo empowers young creators to build verified digital identities, earn reputation tokens, and access global opportunities through the Base network.
                  </p>
                  <div class="q-gutter-md">
                    <q-btn
                      @click="connectWallet"
                      color="white"
                      text-color="primary"
                      size="lg"
                      unelevated
                      rounded
                      icon="rocket_launch"
                      label="Get Started"
                      :loading="walletStore.isConnecting"
                    />
                    <q-btn
                      @click="scrollTo('features')"
                      outline
                      color="white"
                      size="lg"
                      rounded
                      icon="play_arrow"
                      label="Learn More"
                    />
                  </div>
                </div>
                <div class="col-12 col-md-6">
                  <div class="flex justify-center">
                    <q-card style="background: rgba(255,255,255,0.1); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.2); max-width: 400px;">
                      <q-card-section style="background: white; border-radius: 15px; margin: 1rem;">
                        <div class="flex flex-center q-mb-md">
                          <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white;">
                            <q-icon name="person" size="2rem" />
                          </div>
                        </div>
                        <div class="text-center">
                          <div class="text-h6">Digital Identity NFT</div>
                          <div class="text-caption text-grey-6">Verified • Base Network</div>
                        </div>
                      </q-card-section>
                      <q-card-section class="row justify-around text-white">
                        <div class="text-center">
                          <div class="text-caption">Contributions</div>
                          <div class="text-h6">12</div>
                        </div>
                        <div class="text-center">
                          <div class="text-caption">Reputation</div>
                          <div class="text-h6">850</div>
                        </div>
                        <div class="text-center">
                          <div class="text-caption">Verifications</div>
                          <div class="text-h6">8</div>
                        </div>
                      </q-card-section>
                    </q-card>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Features Section -->
          <section id="features" style="padding: 6rem 2rem; background: #f8fafc;">
            <div class="container" style="max-width: 1200px; margin: 0 auto;">
              <div class="text-center q-mb-xl">
                <h2 style="font-size: 2.5rem; font-weight: 700; margin-bottom: 1rem;">Powerful Features</h2>
                <p style="font-size: 1.25rem; color: #64748b; max-width: 600px; margin: 0 auto;">
                  Everything you need to build and verify your digital identity
                </p>
              </div>
              
              <div class="row q-col-gutter-lg">
                <div class="col-12 col-md-4" v-for="feature in features" :key="feature.title">
                  <q-card flat bordered class="full-height" style="transition: all 0.3s; border-top: 4px solid transparent;" 
                          @mouseenter="$event.target.style.transform = 'translateY(-5px)'; $event.target.style.borderTopColor = '#667eea';"
                          @mouseleave="$event.target.style.transform = 'none'; $event.target.style.borderTopColor = 'transparent';">
                    <q-card-section class="text-center">
                      <div class="q-mb-md">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                          <q-icon :name="feature.icon" size="2rem" color="white" />
                        </div>
                      </div>
                      <h3 class="text-h6 q-mb-sm">{{ feature.title }}</h3>
                      <p class="text-body2 text-grey-7">{{ feature.description }}</p>
                    </q-card-section>
                  </q-card>
                </div>
              </div>
            </div>
          </section>

          <!-- How It Works -->
          <section id="how-it-works" style="padding: 6rem 2rem;">
            <div class="container" style="max-width: 1200px; margin: 0 auto;">
              <div class="text-center q-mb-xl">
                <h2 style="font-size: 2.5rem; font-weight: 700; margin-bottom: 1rem;">How Nimo Works</h2>
                <p style="font-size: 1.25rem; color: #64748b;">Get started in four simple steps</p>
              </div>
              
              <div class="row q-col-gutter-lg">
                <div class="col-12 col-sm-6 col-lg-3" v-for="(step, index) in steps" :key="step.title">
                  <div class="text-center">
                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: white; font-size: 1.5rem; font-weight: bold;">
                      {{ index + 1 }}
                    </div>
                    <h3 class="text-h6 q-mb-sm">{{ step.title }}</h3>
                    <p class="text-body2 text-grey-7">{{ step.description }}</p>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Stats -->
          <section style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 4rem 2rem; color: white;">
            <div class="container" style="max-width: 1200px; margin: 0 auto;">
              <div class="row q-col-gutter-lg text-center">
                <div class="col-12 col-sm-6 col-lg-3" v-for="stat in stats" :key="stat.label">
                  <h3 style="font-size: 3rem; font-weight: 700;">{{ stat.value }}</h3>
                  <p style="font-size: 1.1rem; opacity: 0.9;">{{ stat.label }}</p>
                </div>
              </div>
            </div>
          </section>

          <!-- CTA -->
          <section style="padding: 6rem 2rem; background: #f8fafc; text-align: center;">
            <div class="container" style="max-width: 800px; margin: 0 auto;">
              <h2 style="font-size: 2.5rem; font-weight: 700; margin-bottom: 1rem;">Ready to Build Your Future?</h2>
              <p style="font-size: 1.25rem; color: #64748b; margin-bottom: 2rem;">
                Join thousands of creators building their reputation on Base
              </p>
              <q-btn
                @click="connectWallet"
                color="primary"
                size="lg"
                unelevated
                rounded
                icon="account_balance_wallet"
                label="Connect Wallet & Start"
                :loading="walletStore.isConnecting"
              />
            </div>
          </section>

          <!-- Footer -->
          <footer style="background: #1a1a2e; color: white; padding: 3rem 2rem 1rem;">
            <div class="container" style="max-width: 1200px; margin: 0 auto;">
              <div class="row q-col-gutter-lg q-mb-lg">
                <div class="col-12 col-md-6">
                  <h3 class="text-h6 text-secondary q-mb-md">Nimo</h3>
                  <p class="text-body2" style="color: rgba(255,255,255,0.8);">
                    Building the future of digital identity for young creators on the Base network.
                  </p>
                </div>
                <div class="col-12 col-md-6">
                  <div class="row q-col-gutter-md">
                    <div class="col-6">
                      <h4 class="text-subtitle1 text-secondary q-mb-md">Platform</h4>
                      <div>Features • How It Works • Statistics</div>
                    </div>
                    <div class="col-6">
                      <h4 class="text-subtitle1 text-secondary q-mb-md">Community</h4>
                      <div>Discord • Twitter • GitHub</div>
                    </div>
                  </div>
                </div>
              </div>
              <q-separator color="grey-8" />
              <div class="text-center q-pt-lg">
                <p class="text-body2" style="color: rgba(255,255,255,0.6);">
                  &copy; 2024 Nimo Platform. Built on Base Network.
                </p>
              </div>
            </div>
          </footer>
        </div>
      `
    });
    
    // Dashboard Page Component
    app.component('dashboard-page', {
      setup() {
        const goToLanding = () => router.push('/');
        
        return { walletStore, goToLanding };
      },
      
      template: `
        <div style="min-height: 100vh; background: #f8fafc;">
          <!-- Header -->
          <q-header class="bg-primary">
            <q-toolbar>
              <q-btn flat @click="goToLanding" icon="arrow_back" label="Back to Landing" />
              <q-space />
              <q-toolbar-title>Nimo Dashboard</q-toolbar-title>
              <q-space />
              <q-chip v-if="walletStore.isConnected" color="white" text-color="primary" icon="account_balance_wallet">
                {{ walletStore.formattedAddress }}
              </q-chip>
            </q-toolbar>
          </q-header>

          <!-- Dashboard Content -->
          <div class="q-pa-lg" style="padding-top: 100px;">
            <div class="row q-col-gutter-md">
              <!-- Welcome Card -->
              <div class="col-12">
                <q-card>
                  <q-card-section class="bg-primary text-white">
                    <div class="text-h5">Welcome to Nimo Dashboard</div>
                    <div class="text-subtitle2">Manage your digital identity on Base</div>
                  </q-card-section>
                  <q-card-section>
                    <p>Your decentralized identity dashboard is ready!</p>
                    <div v-if="walletStore.isConnected" class="q-mt-md">
                      <q-chip color="positive" text-color="white" icon="check_circle" class="q-mr-sm">
                        Connected
                      </q-chip>
                      <q-chip color="info" text-color="white" icon="account_balance">
                        {{ walletStore.formattedBalance }} ETH
                      </q-chip>
                    </div>
                  </q-card-section>
                </q-card>
              </div>

              <!-- Stats Cards -->
              <div class="col-12 col-md-4">
                <q-card>
                  <q-card-section>
                    <div class="text-h6">Contributions</div>
                    <div class="text-h3 text-primary">5</div>
                    <div class="text-caption">Total recorded</div>
                  </q-card-section>
                </q-card>
              </div>
              
              <div class="col-12 col-md-4">
                <q-card>
                  <q-card-section>
                    <div class="text-h6">Reputation</div>
                    <div class="text-h3 text-primary">250</div>
                    <div class="text-caption">Tokens earned</div>
                  </q-card-section>
                </q-card>
              </div>
              
              <div class="col-12 col-md-4">
                <q-card>
                  <q-card-section>
                    <div class="text-h6">Verifications</div>
                    <div class="text-h3 text-primary">3</div>
                    <div class="text-caption">Completed</div>
                  </q-card-section>
                </q-card>
              </div>
            </div>
          </div>
        </div>
      `
    });
    
    // 404 Component
    app.component('not-found-page', {
      template: `
        <div class="fullscreen bg-blue text-white text-center q-pa-md flex flex-center">
          <div>
            <div style="font-size: 30vh">404</div>
            <div class="text-h2" style="opacity:.4">Oops. Nothing here...</div>
            <q-btn
              class="q-mt-xl"
              color="white"
              text-color="blue"
              unelevated
              @click="() => router.push('/')"
              label="Go Home"
            />
          </div>
        </div>
      `
    });
    
    // Initialize app
    app.use(Quasar, {
      config: {
        brand: {
          primary: '#5c6bc0',
          secondary: '#26a69a',
          accent: '#9c27b0',
          positive: '#21ba45',
          negative: '#c10015',
          info: '#31ccec',
          warning: '#f2c037'
        }
      }
    }).mount('#app');
  </script>
</body>
</html>